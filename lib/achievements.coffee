Achiever = require './achiever'

module.exports =

  activate: (state) ->
    @achiever =
      if state? and state.achieverState?
        Achiever.deserialize(state.achieverState)
      else
        new Achiever()

    # Bronze trophy!
    atom.emit "achievement:unlock",
      name: "You're an achiever!"
      requirement: "Enabled the achievements package."
      category: "installation"
      package: "achievements"
      points: 500
      iconURL: "data:image/png;base64,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"

  deactivate: ->
    @achiever.destroy()

  serialize: ->
    achieverState: @achiever.serialize()

  config:
    # How long the achievement message is kept up for
    NoticeDelay:
      type: 'integer'
      default: 2500
